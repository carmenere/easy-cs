# Table of contents
- [Table of contents](#table-of-contents)
- [Задача](#задача)
  - [Решение 1](#решение-1)
  - [Решение 2](#решение-2)
- [Треугольник Паскаля](#треугольник-паскаля)
- [Симметричность сочетаний](#симметричность-сочетаний)
- [Количество всех сочетаний для некоторого n](#количество-всех-сочетаний-для-некоторого-n)
- [Умножение сочетаний](#умножение-сочетаний)
  - [Задача 1](#задача-1)
    - [Решение 1](#решение-1-1)
    - [Решение 2](#решение-2-1)
    - [Вывод](#вывод)
  - [Задача 2: обобщение первой задачи](#задача-2-обобщение-первой-задачи)
    - [Решение 1](#решение-1-2)
    - [Решение 2](#решение-2-2)
    - [Вывод](#вывод-1)

<br>

# Задача
Есть **таблица**, состоящая из **m+1** клеток по **вертикали** и **k+1** клеток по **горизонтали**.<br>
![spider_nm_1](/img/spider_nm_1.png)

Нужно добраться из **левой верхней** клетки (обозначена как **S**) в **правую нижнюю** (обозначена как **D**).<br>
При этом разрешается перемещаться только **на один шаг**, при этом на **каждом** шаге можно двигаться **только** в **2-х** направлениях:
- либо **вправо**;
- либо **вниз**;

**Сколько** существует способов добраться из клетки **S** в клетку **D**?<br>

<br>

Рассмотрим 2 варианта:
- когда мы **всё время движемся влево**: очевидно, что мы можем пройти весь **первый ряд** (из **S** в **A**) за **k** шагов;
- когда мы **всё время движемся вниз**: очевидно, что мы можем пройти весь **первый столбец** (из **S** в **B**) за **m** шагов;

Пример для горизонтального движения **только** вправо:<br>
![spider_nm_2](/img/spider_nm_2.png)

Очевидно следующее:
- существует ровно **1** способ добраться из клетки **S** в **любую** клетку в **первом** горизонтальном **ряду**;
- существует ровно **1** способ добраться из клетки **S** в **любую** клетку в **первом** вертикальном **столбце**;

<br>

Будем последовательно записывать в каждую клетку таблицы число способов добраться с неё.<br>

**Сколько** существует способов добраться во **вторую** клетку **второго** ряда?<br>
![spider_nm_3](/img/spider_nm_3.png)

Чтобы в неё попасть, мы должны сначала оказаться либо **над** ней, либо **слева** от неё. Поэтому существует **1 + 1** способа попасть в неё.<br>
Это правило справедливо для каждой клетки, поэтому в **каждой** клетке будет число, равное **сумме двух чисел**: числа в клетке **над** ней и числа в клетке **слева** от неё.<br>

<br>

## Решение 1
Длина пути из **S** в **D** всегда будет **k+m**: **m** шагов по **вертикали** и **k** шагов по **горизонтали**.<br>
На каждой клетке имеется **2 варианта** выбора: либо $`\rightarrow`$ либо $`\downarrow`$.<br>
Значит **любой путь** по сути есть **последовательность** $`\rightarrow`$ и $`\downarrow`$ **стрелок**.<br>
Т.о. мы получаем последовательность длиной **(k+m)**, которая состоит из **k** символов $`\rightarrow`$ и **m** символов $`\downarrow`$, например, такую:<br>
![spider_nm_5](/img/spider_nm_5.png)

Согласно формуле **перестановок с повторениями**, мы получим: $`P_{k,m}^{k+m} = {\frac {(k+m)!}{k!m!}}`$.<br>

<br>

## Решение 2
Рассмотрим последовательность из **m+k** **пустых** ячеек:<br>
![spider_nm_7](/img/spider_nm_7.png)

<br>

Проиндексируем все ячейки в этой последовательности, начиная с **1** до **m+k** включительно.<br>

Получается, что у нас имеется:
- $`C_{m}^{k+m} = {\frac {(k+m)!}{(k+m-m)!\cdot m!}} = {\frac {(k+m)!}{k!\cdot m!}}`$ способов выбрать **индексы** для $`m`$ **вертикальных** ходов;
- $`C_{k}^{k+m} = {\frac {(k+m)!}{(k+m-k)!\cdot k!}} = {\frac {(k+m)!}{k!\cdot m!}}`$ способов выбрать **индексы** для $`k`$ **горизонтальных** ходов;

<br>

Это можно **интерпретировать** так: выбрав $`k`$ **горизонтальных** ходов, мы автоматически выбираем $`m`$ *оставшихся* **вертикальных** ходов.<br>
А значит, общее количество вариантов равно **или** $`C_{k}^{k+m}`$ **или** $`C_{m}^{k+m}`$.<br>

<br>

Если $`k+m`$ переписать как $`n`$, а $`m`$ как $`n-k`$, то получим: $`C_{k}^{n} = C_{n-k}^{n}`$.<br>

Это можно **интерпретировать** так: выбрав $`k`$ элементов из $`n`$, мы автоматически выбираем $`n-k`$ **оставшихся** элементов.<br>

<br>

# Треугольник Паскаля
Вернемся к таблице:<br>
![spider_nm_3](/img/spider_nm_3.png)

<br>

Мы установили, что $`C_{i}^{i+j}`$ это количество способов попасть в клетку таблицы с координатами $`(i,j)`$, где:
- $`i`$ - количество шагов по **горизонтали** *вправо* или номер **столбца**;
- $`j`$ - количество шагов по **вертикали** *вниз* или номер **строки**;

<br>

Если в каждой клетке изначальной таблицы записать число сочетаний, то получим такую таблицу:
||i=0|i=1|i=2|i=3|i=4|i=5|
|:-|:-|:-|:-|:-|:-|:-|
|**j=0**|$`C^{0}_{0}`$|$`C^{1}_{1}`$|$`C^{2}_{2}`$|$`C^{3}_{3}`$|$`C^{4}_{4}`$|$`C^{5}_{5}`$|
|**j=1**|$`C^{1}_{0}`$|$`C^{2}_{1}`$|$`C^{3}_{2}`$|$`C^{4}_{3}`$|$`C^{5}_{4}`$|$`C^{6}_{5}`$|
|**j=2**|$`C^{2}_{0}`$|$`C^{3}_{1}`$|$`C^{4}_{2}`$|$`C^{5}_{3}`$|$`C^{6}_{4}`$|$`C^{7}_{5}`$|
|**j=3**|$`C^{3}_{0}`$|$`C^{4}_{1}`$|$`C^{5}_{2}`$|$`C^{6}_{3}`$|$`C^{7}_{4}`$|$`C^{8}_{5}`$|
|**j=4**|$`C^{4}_{0}`$|$`C^{5}_{1}`$|$`C^{6}_{2}`$|$`C^{7}_{3}`$|$`C^{8}_{4}`$|$`C^{9}_{5}`$|
|**j=5**|$`C^{5}_{0}`$|$`C^{6}_{1}`$|$`C^{7}_{2}`$|$`C^{8}_{3}`$|$`C^{9}_{4}`$|$`C^{10}_{5}`$|

<br>

Вычислив эти значения получим таблицу:<br>
![spider_nm_4](/img/spider_nm_4.png)

<br>

Рассмотрим числа в выделенных **диагоналях**: каждая диагональ выделена **одинаковым цветом**, цвета диагоналей **чередуются**.<br>
Если выписывать числа, стоящие в этих диагоналях, то мы получим **треугольник Паскаля**.<br>

<br>

Мы видим, что **треугольник Паскаля** образуется числами вида:
- $`C^{0}_{0} = 1`$
- $`C^{1}_{0} = 1, \space C^{1}_{1} = 1`$
- $`C^{2}_{0} = 1, \space C^{2}_{1} = 2, \space C^{2}_{2} = 1`$
- $`C^{3}_{0} = 1, \space C^{3}_{1} = 3, \space C^{3}_{2} = 3, \space C^{3}_{3} = 1`$
- $`C^{4}_{0} = 1, \space C^{4}_{1} = 4, \space C^{4}_{2} = 6, \space C^{4}_{3} = 4, \space C^{4}_{4} = 1`$
- ...

<br>

Получается, что **каждый ряд** в **треугольнике Паскаля** - это все такие **числа сочетаний** $`C_{i}^{i+j}`$ из этой таблицы, у которых $`n=i+j`$ **одинаково**.<br>

<br>

# Симметричность сочетаний
Мы видими следующее свойство **треугольника Паскаля**:<br>
![](/img/pascal_triangle_animated.gif)

Из чего следует, что: $`C^{n}_{k}=C^{n-1}_{k-1}+C^{n-1}_{k}`$ для всех $`n,k`$ таких, что $`1 \leq k \lt n`$.

<br>

**Доказательство**.<br>
Рассмотрим группу из **n** человек. Из этой группы нужно выбрать **k** человек. <br>
Сколько сущствует способов сделать это?<br>
Мы уже знаем что это число сочетаний: $`C^{n}_{k}`$.<br>

<br>

Но, эту задачу можно решить еще и так: если мы выделим некоторого человека, то мы можем сформировать две группы из **k** человек:
- **первая** группа содержит этого выделенного человека: в этом случае, мы **фиксируем** в группе **одного** человека и **исключаем** его из общего количества вариантов выбора, а значит мы должны выбрать **k-1** человек из **n-1** человек:
  - количество таких вариантов: $`C^{n-1}_{k-1}`$;
- **вторая** группа **не** содерижт этого человека: в этом случае, мы просто **исключаем** его из общего количества вариантов выбора, а значит мы должны выбрать **k** человек из **n-1** человек:
  - количество таких вариантов: $`C^{n-1}_{k}`$;

<br>

Визуализация:<br>
![](/img/spider_nm_6.png)

<br>

Т.о. **общее** количество вариантов $`C^{n-1}_{k-1} + C^{n-1}_{k} \implies C^{n}_{k} = C^{n-1}_{k-1} + C^{n-1}_{k}`$

<br>

# Количество всех сочетаний для некоторого n
$`\sum_{i=0}^{i=n} C^{n}_{k} = C^{n}_{0} + C^{n}_{1} + C^{n}_{2} + ... + C^{n}_{i} + ... + C^{n}_{n-1} + C^{n}_{n} = 2^n`$.<br>

<br>

Пусть у нас есть **n** элементов, тогда:
- $`C^{n}_{0}`$ - это количество способов выбрать **0** элементов из **n**;
- $`C^{n}_{1}`$ - это количество способов выбрать **1** элемент из **n**;
- ...
- $`C^{n}_{n}`$ - это количество способов выбрать **n** элементов из **n**;

<br>

Т.о. $`2^n`$ это количество способов выбрать из **n** человек **все возможные группы всех размеров**: от **0** до **n** человек.<br>

<br>

# Умножение сочетаний
## Задача 1
**Сколько** существует способов выбрать из **n** человек **команду**, состоящую из **k** человек, а затем **внутри** этой команды сназначить **1** капитана?<br>

<br>

### Решение 1
Выбрать капитана можно **n** способами. После каждого такого выбора:
- количество свободных мест в команде **уменьшится** и станет **k-1**;
- для выбора останутся **доступными n-k** человек;

Т.е. нужно будет выбрать **k-1** человек из **n-1**.<br>

Итого: $`n \cdot C^{n-1}_{k-1}`$.

<br>

### Решение 2
Выбрать команду размера **k** из **n** человек можно $`C^{n}_{k}`$ способами.
После каждого такого выбора в команду размера **k** можно выбрать капитана **k** способами.

Итого: $`k \cdot C^{n}_{k}`$.

<br>

### Вывод
$`n \cdot C^{n-1}_{k-1} = k \cdot C^{n}_{k}`$

<br>

## Задача 2: обобщение первой задачи
Сколько существует способов выбрать из **n** человек **команду**, состоящую из **k** человек, а затем **внутри** этой команды сформировать **штаб** из **m** человек?<br>
$`0 \le m \le k \le n`$.<br>

<br>

### Решение 1
Существует $`C^{n}_{k}`$ способов выбрать команду из **k** человек.<br>
После каждого такого выбора существует $`C^{k}_{m}`$ способов сформировать **штаб** из **m** человек.<br>

А значит **общее** количество вариантов: $`C^{n}_{k} \cdot C^{k}_{m}`$.<br>

<br>

### Решение 2
Существует $`C^{n}_{m}`$ способов сформировать **штаб** из **m** человек.<br>
После того, как **штаб** сформирован, в команде остается еще **k-m** **свободных** мест, а для выбора остаются **доступными n-m** вариантов. А значит существует $`C^{n-m}_{k-m}`$ вариантов заполнить оставшиеся места в команде.<br>

А значит **общее** количество вариантов: $`C^{n}_{m} \cdot C^{n-m}_{k-m}`$.<br>

<br>

### Вывод
$`C^{n}_{k} \cdot C^{k}_{m} = C^{n}_{m} \cdot C^{n-m}_{k-m}`$.<br>
