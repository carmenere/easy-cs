# Table of contents
- [Table of contents](#table-of-contents)
- [Преобразования](#преобразования)
- [Подвижные и неподвижные точки](#подвижные-и-неподвижные-точки)
- [Графы преобразований](#графы-преобразований)
- [Перестановки](#перестановки)
  - [Графы перестановок](#графы-перестановок)
  - [Нотации перестановок](#нотации-перестановок)
    - [Two-line notation](#two-line-notation)
    - [One-line notation](#one-line-notation)
- [Произведение перестановок](#произведение-перестановок)
  - [Визуализцаия произведения перестановок](#визуализцаия-произведения-перестановок)
  - [Тождественная перестановка](#тождественная-перестановка)
  - [Обратная перестановка](#обратная-перестановка)
- [Взаимно простые перестановки](#взаимно-простые-перестановки)
- [Орибты и циклы](#орибты-и-циклы)
  - [Свойства орбит](#свойства-орбит)
- [Циклические перестановки](#циклические-перестановки)
  - [Cycle notation](#cycle-notation)
  - [Canonical cycle notation](#canonical-cycle-notation)
- [Пример разложения перестановки в произведение независимых циклов](#пример-разложения-перестановки-в-произведение-независимых-циклов)
- [Инверсии](#инверсии)
- [Транспозиции](#транспозиции)
  - [Разложение циклов в произведение транспозиций](#разложение-циклов-в-произведение-транспозиций)
  - [Разложение перестановок в произведение транспозиций](#разложение-перестановок-в-произведение-транспозиций)
  - [Смежные транспозиции](#смежные-транспозиции)
- [Чётность перестановки](#чётность-перестановки)
  - [Через подсчет числа инверсий](#через-подсчет-числа-инверсий)
  - [Через подсчет числа транспозиций](#через-подсчет-числа-транспозиций)
- [Свойства транспозиций](#свойства-транспозиций)
- [Порядок перестановки](#порядок-перестановки)
- [Связь перестановок с числами Стирлинга первого рода](#связь-перестановок-с-числами-стирлинга-первого-рода)

<br>

# Преобразования
Очень часто приходится рассматривать **отображения** (**mappings**) некоторого множества $`M`$ в себя. Такие *отображения* некоторого множества $`M`$ в себя называются **преобразованияями** (**transformations**).<br>

Изучая **преобразования** произвольного конечного множества, удобно придерживаться определенных стандартных обознвачений. Природа элементов множества $`M`$ при изучении его преобразований - **несущественна**. Следовательно, мы можем **занумеровать** все элементы множества $`M`$ и оперировать **не** с самими элементами, а с их **номерами**. Поэтому, рассматривая **преобразования** конечных множеств, мы будем иметь дело с множеством $`M = \{1, 2, 3, ..., n\}`$, где $`n \in \mathbb {N}`$.<br>

**Преобразование** конечного множества $`M`$ (или на множестве $`M`$) часто обозначают строчными буквами греческого алфавита или заглавными латинскими баквами и записывают в виде таблицы, например:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & \dots & n-1 & n \\
    2 & 3 & 4 & \dots & n & 1
\end{matrix}\right)`$
<br>

где
- $`\phi`$ - обозначение преобразования;
- в **верхней** строке - **аргументы**, обычно отсортированные по возрастанию;
- в **нижней** строке - **значения** функции;

<br>

Например, если $`M = \{1, 2, 3, 4, 5\}`$, то:<br>

$`a) \space \phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    2 & 3 & 4 & 1 & 5
\end{matrix}\right), \space \space \space b) \space \psi = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    5 & 4 & 3 & 2 & 1
\end{matrix}\right)`$ <br>

есть таблицы **разных** *преобразований* $`\phi`$ и $`\psi`$ на множестве $`M`$.<br>

Некоторые преобразования конечного множества $`M`$ имеют специальные названия:
1. **Тождественное преобразование** - преобразование, которое все элементы оставляет на месте, это преобразование имеет таблицу:
$`\left( \begin{matrix}
    1 & 2 & 3 & \dots & n-1 & n \\
    1 & 2 & 3 & \dots & n-1 & n
\end{matrix}\right)`$
1. **Постоянное преобразование** - преобразование, которое каждому элементу из $`M`$ ставит в соответсвие один и тот же элемент, это преобразование имеет таблицу:
$`\left( \begin{matrix}
    1 & 2 & 3 & \dots & n-1 & n \\
    1 & 1 & 1 & \dots & 1 & 1
\end{matrix}\right)`$
1. **Перестановка**.

<br>

# Подвижные и неподвижные точки
**Подвижная точка** (**non-fixed point**) преобразования $`\phi`$ конечного множества $`M`$ - это такой элемент $`a∈M`$, для которого справедливо равенство $`\phi(a) \ne a`$.<br>
**Неподвижная точка** (**fixed point**) преобразования $`\phi`$ конечного множества $`M`$ - это такой элемент $`a∈M`$, для которого справедливо равенство $`\phi(a) \ne a`$.<br>

<br>

**Степень преобразования** $`\phi`$ - количество подвижных точек преобразования $`\phi`$.<br>
Например,
- **тождественное преобразование** имеет **степень нуль**;
- **постоянное преобразование** имеет **степень n-1**;

<br>

# Графы преобразований
Любое **преобразование** $`\phi`$ можно представить в виде **орграфа**:
- отметим вершины $`1, 2, ..., n`$;
- далее: 
  - если $`\phi(i) = j`$ то рисуем **дугу** из $`i`$ в $`j`$;
  - если $`\phi(i) = i`$ то рисуем **петлю**;

<br>

**Подвижная точка** на орграфе преобразования - это точка **без** петель.<br>
**Неподвижная точка** на орграфе преобразования - это точка **с** петлёй.<br>

<br>

# Перестановки
**Перестановка** (**permutation**) $`\phi`$ конечного множества $`M`$ (или на множестве $`M`$) - это **биекция** конечного мнжества на себя. Другими словами, $`\phi`$ есть **перестановка** на $`M = \{1, 2, 3, ..., n\}`$ тогда и только тогда, когда для произвольных элементов $`a∈M`$ и $`b∈M`$ таких, что $`a \ne b`$ имеем $`\phi(a) \ne \phi(b)`$.<br>

## Графы перестановок
Если *преобрзаование* $`\phi`$ является **перестановкой** на множестве $`M`$, то
- **из** *каждой вершины* **орграфа**, соответствующего перестановке, **выходит одна и только одна** стрелка;
- **в** *каждую вершину* **орграфа**, соответствующего перестановке, **входит одна и только одна** стрелка;

Пусть **перестановка** $`\phi`$ множества $`M = \{1, 2, 3, 4, 5, 6\}`$ задана таблицей:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 & 6 \\
    3 & 4 & 1 & 5 & 6 & 2
\end{matrix}\right)`$

<br>

Ее можно изобразить в виде следующего **орграфа**:
![permutation_orgraph](/img/permutation_orgraph.png)

<br>

Мы видим, что **орграф** произвольной *перестановки* образует один **цикл** или **распадается** на **несколько** независымх **циклов**.

<br>

## Нотации перестановок
### Two-line notation
**Перестановка** $`\phi`$ на $`M = \{1, 2, 3, ..., n\}`$ задается таблицей вида (aka **two-line notation**):<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & \dots & n-1 & n \\
    \phi(1) & \phi(2) & \phi(3) & \dots & \phi(n-1) & \phi(n)
\end{matrix}\right)`$, где 
<br>

$`\phi(1), \space \phi(2), \space \phi(3), \space \dots, \space \phi(n-1), \space \phi(n)`$ - **разные** элементы из $`M`$.<br>

<br>

Читать такую таблицу следует так: **перестановка** $`\phi`$ *переводит* (*sends*):
- элемент $`1`$ в элемент $`\phi(1)`$;
- элемент $`2`$ в элемент $`\phi(2)`$;
- ...
- элемент $`n`$ в элемент $`\phi(n)`$;

<br>

### One-line notation
Перестановки иногда записывают в **один ряд** (aka **one-line notation**), который содержит **только значения функции**, *опуская верхний ряд*.<br>

Чтобы отличать *one-line notation* от **cycle notation** в записи *one-line notation* **опускают круглые скобки** и **все** элементы пишут **слитно**, поэтому она еще называется **word representation**:<br>

$`\phi = \phi(1)\phi(2)\phi(3)\dots\phi(n-1)\phi(n)`$.<br>

<br>

**Например**, запись:<br>

$`\phi = a_{1}a_{2}a_{3}\dots a_{n-1}, \space a_{n}`$
<br>

**эквивалентна** записи:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & \dots & n-1 & n \\
    a_{1} & a_{2} & a_{3} & \dots & a_{n-1} & a_{n}
\end{matrix}\right)`$.
<br>

<br>

# Произведение перестановок
**Произведение перестановок** (aka **композиция перестановок**) - это последовательное применение перестановок.<br>

Нотация. **Композция** $`H`$ двух разных перестановок $`G`$ и $`F`$ записывается так:<br>
$`H = G \circ F`$<br>

**Композиция** вычисляется **справа налево**, т.е. **сначала** применяется **правая** перестановка $`F`$, а **затем**, к ее **результату** применяется **левая** перестановка $`G`$.<br>

Т.к. перестановки это биекции, то композицию перестановок можно переписать в нотации функций: $`H(a_{i}) = G(F(a_{i}))`$, другими словами, чтобы найти куда $`H`$ отображает элемент $`a_{i}`$, надо сначала найти $`F(a_{i})`$, а потом $`G(F(a_{i}))`$.<br>

**В общем случае**, произведение перестановок **не коммутативно**.<br>

<br>

## Визуализцаия произведения перестановок
Даны 2 перестановки:<br>

$`F = \left( \begin{matrix}
    1 & 2 & 3 \\
    3 & 2 & 1
\end{matrix}\right) \space \space G = \left( \begin{matrix}
    1 & 2 & 3 \\
    2 & 3 & 1
\end{matrix}\right)`$

<br>

$`H = G \circ F`$:<br>
![composition_visualisation](/img/composition_visualisation.png)

<br>

## Тождественная перестановка
**Тождественная перестановка** $`I`$ или $`\varepsilon`$ - такая перестановка, которая переводит каждый элемент из $`M`$ в себя же.<br>

Таблица *тождественной перестановки*:<br>

$`I = \left( \begin{matrix}
    1 & 2 & 3 & \dots & n-1 & n \\
    1 & 2 & 3 & \dots & n-1 & n
\end{matrix}\right)`$

<br>

**Свойства**:
- для заданного множества $`M`$ существует **только одна** *тождественная перестановка*;

<br>

## Обратная перестановка
**Обратная перестановка** $`F^{-1}`$ - такая перестановка, которую, если применить к результату перестановки $`F`$, то она **вернет** все элемента на те места, на которых они были **до** применения перестановки $`F`$.<br>

$`I = \left( \begin{matrix}
    1 & 2 & 3 & \dots & n-1 & n \\
    1 & 2 & 3 & \dots & n-1 & n
\end{matrix}\right)`$

<br>

**Свойства**:
- произведение **перестановки на обратную к ней** дает **тождественную** перестановку: $`I = F \circ F^{-1}`$;
- **левая** и **правая** обратные подстановки **совпадают**: $`F \circ F^{-1} = F^{-1} \circ F = I`$;

<br>

Если перестановка записана как произведение *независимых циклов* в **cycle notation**, то **обратная** к ней перестановка ищется путем обратной записи всех ее элементов, это объясняется так: чтобы получить **обратную перестановку** - необходимо пройти по *циклу* в **обратном** направлении.

Например, дана перестановка $`\phi = (ghijk)(lmn)`$, у не есть **2 цикл**а:
- $`g \rightarrow h \rightarrow i \rightarrow j \rightarrow k \rightarrow g`$
- $`l \rightarrow m \rightarrow n \rightarrow l`$

Чтобы получить обратную к ней, запишем циклы в **обратном** направлении (справа налево):
- $`g \rightarrow k \rightarrow j \rightarrow i \rightarrow h \rightarrow g`$
- $`l \rightarrow n \rightarrow m \rightarrow l`$

А значит: $`a^{-1} = (gkjih)(lnm)`$.<br>

<br>

# Взаимно простые перестановки
Две перестановки $`\phi`$ и $`\psi`$ на множестве $`M`$ называются **взаимно простыми**, если их множества **подвижных** точек **не** имеют **общих** элементов.<br>

**Пример**:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    3 & 1 & 2 & 4 & 5
\end{matrix}\right) \space \space \psi = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    1 & 2 & 3 & 5 & 4
\end{matrix}\right)`$

Множество **подвижных точек** для $`\phi`$ является $`\{1,2,3\}`$, а для $`\psi`$ является $`\{4,5\}`$, они не содержат общих элементов, значит эти перестановки **взаимно простые**.<br>

**Произведение** двух **взаимно простых** перестановок **коммутативно**:<br>

$`\left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    3 & 1 & 2 & 4 & 5
\end{matrix}\right) \space \circ \space \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    1 & 2 & 3 & 5 & 4
\end{matrix}\right) = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    3 & 1 & 2 & 5 & 4
\end{matrix}\right)`$

<br>

$`\left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    1 & 2 & 3 & 5 & 4
\end{matrix}\right) \space \circ \space \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    3 & 1 & 2 & 4 & 5
\end{matrix}\right) = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 \\
    3 & 1 & 2 & 5 & 4
\end{matrix}\right)`$

В обоих случаях получаем одинаковый результат: $`31254`$.

<br>


# Орибты и циклы
Пусть $`\phi`$ произвольная **перестановка** множества $`M = \{1, 2, 3, ..., n\}`$ и $`a`$ произвольный элемент из $`M`$, **мощность** множества $`M`$ равна $`n`$.<br>

Рассмотрим **последовательность** элементов из $`M`$: $`a = a_{1}, \space \phi(a_1) = a_{2}, \space \phi(a_{2}) = a_{3}, \space \phi(a_{3}) = a_{4}, \space \dots, \space \phi(a_{j}) = a_{j+1}, \space ... `$. Очевидно, что элементы в этой *последовательности* начнут **повторяться**, начиная с некоторого места, образуя таким образом **цикл**.<br>

Пусть $`k`$ **наменьшее** число такое, что $`\phi(a_{k}) = a_{k+1} = a_{l}`$.<br>
Ясно, что $`\phi(a_{k})`$ переведет элемент $`a_{k}`$ в один из элементов множества $`\{a_{1}, \space a_{2}, \space a_{3}, \dots, a_{k-1}, \space a_{k}\}`$, т.к. множество $`M`$ конечно и состоит из $`n`$ элементов, а значит $`l \in \{1,2,\dots,n\}`$.<br>
Поскольку $`k`$ **наменьшее** число такое, что $`\phi(a_{k}) = a_{k+1} = a_{l}`$, то оно **не** может быть больше мощности множества $`M`$, другими словами: $`1 \le k \le n`$.<br>
Рассмотрим 2 случая: $`l \ne 1`$ и $`l = 1`$, в обоих случаях *преобразование* $`\phi`$ образует **цикл** длины $`k`$, но:<br>
- в случае $`l \ne 1`$ *преобразование* $`\phi`$ **не** является *перестановкой*, т.к. в точку $`a_{l}`$ будут входить **2** стрелки, это следует из того, что элемент $`a_{l}`$ уже встречался как минимум один раз **внутри** *последовательности*, т.к. $`l < k`$;
- в случае $`l = 1`$ *преобразование* $`\phi`$ **является** *перестановкой*, т.к. в самый первый элемент *последовательности* $`a_{1}`$ будут входить только **1** стрелка, т.к. ранее в него не входило еще стрелок;

<br>

Последовательность элементов $`a = a_{1}, \space \phi(a_1) = a_{2}, \space \phi(a_{2}) = a_{3}, \space \phi(a_{3}) = a_{4}, \space \dots, \space \phi(a_{k-1}) = a_{k}`$ множества  $`M`$ называется **орбитой** (**orbit**) элемента $`a`$ для **перестановки** $`\phi`$ и обозначается $`O(a, \phi)`$.

Можество $`O(a, \phi)`$ элементов **орбиты** является **подмножеством** множества $`M`$:<br>
$`O(a, \phi) = \{a_{1}, \space a_{2}, \space a_{3}, \dots, a_{k-1}, \space a_{k}\}`$, где $`a_{i}∈M \space \forall i \in [1,k]`$.<br>

**Мощность** *орибты* равна $`k`$: $`|O(a, \phi)| = k`$<br>

<br>

## Свойства орбит
**Любая** *перестановка* разбивает множество $`M`$ на **орибты** и при этом **разные** *орибты* **не** содержат **общих** элементов, т.е. **пересечение** *любых двух* **орбит** даст **пустое множество**.<br>

Пусть $`\phi`$ произвольная перестановка на множестве $`M = \{1, 2, 3, ..., n\}`$, которая разбивает его на $`s`$ (при этом $`s \le n`$) **орбит**: $`O_{1}, \space O_{2}, \space \dots, \space O_{s}`$.<br>

Это **разбиение** на **орбиты** обладает следующими **свойствами**:
- если $`i \ne j`$ то: $`O_{i}∩O_{j}=\emptyset`$, другими словами, $`O_{i}`$ и $`O_{j}`$ **не** имеют **общих** элементов;
  - **следствие**: *каждый* элемент из $`M`$ попадает в *одну* конкретную *орбиту* $`O_{i} \space \space i=1,2,\dots,s`$;
- если $`o \in O_{i}`$ то и $`\phi(o) \in O_{i}`$

<br>

Два крайних случая разбиения на **орбиты**:
- *перестановка* разбивает множество $`M`$ на **n** *орбит*: каждая *орбита* будет состоять из **одного** элемента, а *перестановка* распадется на $`n`$ **циклов** длины $`1`$. Очевидно, что такая *перестановка* **не** содержит **ни одной** *подвижной точки*;
- *перестановка* разбивает множество $`M`$ на **одну** *орбиту*: эта *орбита* будет включать **все** элементы из $`M`$: $`O(a, \phi) = M`$, а *перестановка* распадется на **один цикл** длиной $`n`$;
  - пример того, как **цикл** длиной $`n`$ действует на на элементы из $`M`$:
    - $`a = a_{1}, \space \phi(a_1) = a_{2}, \space \phi(a_{2}) = a_{3}, \space \phi(a_{3}) = a_{4}, \space \dots, \space \phi(a_{n-1}) = a_{n}, \space \phi(a_{n}) = a_{0}`$.<br>

<br>

# Циклические перестановки
Пусть $`\phi`$ произвольная перестановка на множестве $`M = \{1, 2, 3, ..., n\}`$, которая разбивает его на $`s`$ ($`s \le n`$) **орбит**: $`O_{1}, \space O_{2}, \space \dots, \space O_{s}`$. Тогда каждой **орбите** $`O_{s}`$ соответствует **независимый цикл** (**disjoint cycle**), причем **длина** этого **цикла** равна **мощности** орибты $`|O_{s}| = k_{s}`$.<br>

**Независимый цикл** из **k** элементов называется **k-цикл** и его длина равна **k**. (A **cycle** consisting of **k** elements is called a **k-cycle**.). Количество элементов в **cycle notation** и есть **длина** этого цикла. Каждый **неподвижный элемент** *перестановки* $`\phi`$ образует **цикл** длины **1** или **1-цикл**.<br>

Каждый **независимый цикл** можно рассматривать как некоторую **перестановку** $`\phi_{i}`$ на множестве $`M`$, у которой множество **подвижных точек** совпадет с ее орбитой $`O_{i}`$, а все остальные элементы переходят в себя, т.е. образуют **неподвижные точки**.<br>

**Более формально**: пусть $`\phi`$ произвольная перестановка на множестве $`M`$, а $`O_{i}`$ одна из ее орбит, тогда перестановка $`\phi_{i}`$ на множестве $`M`$:
- $`\forall o \in O_{i} \implies \phi_{i}(o) \in O_{i}`$;
- $`\forall a \in M: a \notin O_{i} \implies \phi_{i}(a) = a`$;

<br>

Такие перестановки $`\phi_{i}`$ на множестве $`M`$ называются **циклическими перестановками** или просто **циклами**.<br>

**Циклическая перестановка** длины **k** - такая **перестановка** $`\phi`$, у которой **k** *подвижных элементов* и **все** её *подвижные элементы* образуют **один цикл** длины **k**.<br>

Получается, что любая произвольная перестановка $`\phi`$ на множестве $`M`$ разбивается на $`s`$ **независимых циклов**, причем 

*Любую* **перестановку** можно **разложить** в **произведение** всех её **независимых циклов** длины $`l \ge 2`$, причём **единственным образом**. (A **permutation** can be **decomposed** into one or more **disjoint cycles**):<br>

$`\phi = \phi_{1} \circ \phi_{2} \circ \phi_{3} \circ \dots \circ \phi_{s}`$.<br>

Свойства разлоежния:
- в разложении можно **опустить** все **неподвижные элементы** (aka **1-циклы**);
- разложение **не** зависит от порядка множителей, т.к. **все** эти **независимые циклы** в разложении перестановки $`\phi`$ **попарно взаимно просты**, т.е. $`\phi_{i} \ne \phi_{j}`$ если $`i \ne j`$.<br>

<br>

## Cycle notation
Рассмотрим перестановку $`\phi`$:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 \\
    2 & 3 & 1 & 4
\end{matrix}\right)`$.

Данная перестановка $`\phi`$ распадается на один **цикл** длины **3** (**3-цикл**) и одну **неподвижную точку** (**цикл** длины **1**).<br>
Данную перестановку можно визуализировать в виде следующего **орграфа**:<br>
![cycle_notation_orgraph](/img/cycle_notation_orgraph.png)

Очевидно, что какую бы вершину мы не выбрали в качестве первой, мы рано или поздно придем в нее же, поэтому для записи цикла **не важно**, с какой вершины мы начнем.

Например, **3-цикл** рассмотренной выше перестановки $`\phi`$ можно записать в одну строку несколькими способами:
- $`1\rightarrow 2 \rightarrow 3 \rightarrow 1`$;
- $`2\rightarrow 3 \rightarrow 1 \rightarrow 2`$;
- $`3\rightarrow 1 \rightarrow 2 \rightarrow 3`$;

<br>

**Сycle notation** - запись произвольной перестановки в виде **произведение** всех её **независимых циклов**.<br>

Правила записи  $`\phi`$ в **cycle notation**:
- выбираем первую вершину, но на самом деле не имеет значения, какую вершину выбрать в качестве первой;
- далее, выписываем все остальные вершины в том порядке, по поторому мы переходим из одной вершины в другую, **последовательно** двигясь по циклу;
- как только мы дошли до первой вершины, останавливаемся, первую вершину второй раз уже **не** выписываем;
- все записанные вершины заключаем в круглые скобки;
- между вершинами можно ставить **запятые**, но **допускается** и **слитная** запись без разделителей;

<br>

**Безразлично**, с какой позиции записывать цикл, примеры:
- $`(ij) = (ji)`$;
- $`(ijk) = (jki) = (kij)`$;
- $`(ijkl) = (jkli) = ... `$;

<br>

Количество элементов в **cycle notation** и есть **длина** этого цикла. Цикл из **k** элементов называется **k-цикл** и его длина равна **k**.

<br>

Например, **3-цикл** рассмотренной выше перестановки $`\phi`$ в **cycle notation** можно записать следующими способами:
- $`(123)`$ или $`(1,2,3)`$;
- $`(231)`$ или $`(2,3,1)`$;
- $`(312)`$ или $`(3,1,2)`$;

А всю перестановку $`\phi`$ в **cycle notation** можно записать так:
- $`\phi = (123)(4)`$;
- $`\phi = (231)(4)`$;
- $`\phi = (312)(4)`$ this is the **canonical** cycle notation;

<br>

## Canonical cycle notation
The **canonical cycle notation** is *cycle notation* which requires that :
- in each cycle the **largest** element is listed **first**;
- the **cycles** are **sorted** in **increasing** of their **first** element;
- **1-cycles** are not omitted;

<br>

For example, $`{\displaystyle (513)(6)(827)(94)}`$, because $`5 < 6 < 8 < 9`$ and each of them is **largest** in appropriate cycle.<br>

<br>

<br>

# Пример разложения перестановки в произведение независимых циклов
Требуется разложить в произведение циклов следующую перестановку:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    2 & 3 & 1 & 6 & 7 & 4 & 5 & 8
\end{matrix}\right)`$
<br>

Первым делом нужно найти **все** ее **орбиты** и соответвующие им **циклы**:
- **орибта**: $`O_{1} = \{1,2,3\}`$, **цикл**: $`\psi_{1}=(231)`$;
- **орибта**: $`O_{2} = \{4,6\}`$, **цикл**: $`\psi_{2}=(64)`$;
- **орибта**: $`O_{3} = \{5,7\}`$, **цикл**: $`\psi_{3}=(75)`$;
- **орибта**: $`O_{4} = \{8\}`$, **цикл**: $`\psi_{4}=(8)`$;

<br>

Теперь мы можем для каждого **цикла** $`\psi_{i}`$ записать соответствующую ему **циклическую перестановку** $`\phi_{i}`$:<br>

$`\psi_{1}=(231) \implies \phi_{1} = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    2 & 3 & 1 & 4 & 5 & 6 & 7 & 8
\end{matrix}\right) =(231)`$

<br>

$`\psi_{2}=(64) \implies \phi_{2} = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    1 & 2 & 3 & 6 & 5 & 4 & 7 & 8
\end{matrix}\right)=(64)`$

<br>

$`\psi_{3}=(75) \implies \phi_{3} = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    1 & 2 & 3 & 6 & 7 & 4 & 5 & 8
\end{matrix}\right) = (75)`$

<br>

$`\psi_{4}=(8) \implies \phi_{4} = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    1 & 2 & 3 & 6 & 5 & 4 & 7 & 8
\end{matrix}\right) = \varepsilon = (8)`$

<br>

Теперь мы можем разложить перестановку в **произведение** её **циклов**:
$`\phi=\phi_{1} \circ \space \phi_{2} \circ \space \phi_{3} \circ \space \phi_{4} = (231)\circ \space (64) \circ \space (75) \circ \space (8)`$.<br>

Все **неподвижные элементы** (aka **циклы** длины **1**) можно **отбросить** и тогда **разложение** примет итоговый вид:
$`\phi= (231)\circ \space (64) \circ \space (75)`$.

<br>

# Инверсии
**Инверсия** в перестановке $`\phi`$ это число всех таких пар $`\{i,j\}`$ что $`i \lt j`$, **но** $`\phi(i) \gt \phi(j)`$.<br>

Например, для перестановки $`\phi = (45132)`$ **все** её **инверсии**: $`\{1,4\}, \{1,5\}, \{2,4\}, \{2,5\}, \{2,3\}, \{3,4\}, \{3,5\}`$. Всего **7** инверсий. Т.к. **7** - **нечётное** число, то перестановка - **нечётная**.<br>

**Максимальное чило инверсий** содержится в перестановке, все элементы которой отсортированы в **по убыванию**: $`\phi = (n \space n-1 \space \dots \space 3 \space 2 \space 1)`$.<br>

<br>

# Транспозиции
**Транспоизция** - **цикл** длины **2** или **2-цикл**.<br>
При применении **транспозиции** к любой перестановке **только** **2** элемента **меняются** местами.<br>

Пример **транспозиции**:<br>
  
- $`\phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 \\
    3 & 2 & 1 & 4
\end{matrix}\right) = (31)`$;
- $`\phi = (52134) = (51)`$;

<br>

## Разложение циклов в произведение транспозиций
Любой **цикл** может быть разложен в **произведение** (не обязательно независимых) **транспозиций**.

Разложение *циклов* на *произведение транспозиций* **не** является единственным:<br>

$`(123) = (13) \circ (12) = (23) \circ (13) = (13) \circ (24) \circ (24) \circ (12)`$.<br>

<br>

Любой **цикл** длины $`k \ge 2`$ (например, $`(x_{1},\space x_{2},\space x_{3}, \space \dots,\space x_{k})`$ ) можно разложить в *произведение* **ровно** $`k-1`$ *транспозиций* следующим образом:<br>

$`(x_{1},\space x_{2},\space x_{3}, \space \dots,\space x_{k}) = (x_{1},\space x_{k}) \circ (x_{1},\space x_{k-1}) \circ \dots \circ (x_{1},\space x_{3}) \circ (x_{1},\space x_{2})`$.

<br>

## Разложение перестановок в произведение транспозиций
Т.к. любой **цикл** длины $`k \ge 2`$ можно разложить в *произведение транспозиций*, то и любую **перестановку** можно разложить в *произведение транспозиций*. (Every **permutation** is a **product** of **transpositions**).

Рассмотрим перестановку:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 \\
    2 & 3 & 1 & 4
\end{matrix}\right)`$.

Она раскладывается в такое **произведение независимых циклов**: $`\phi = (123)(4)`$.<br>

Рассмотрим цикл $`(123)`$. Есть несколько вариантов разложения его в **произведение транспозиций**:
- $`(123) = (13) \circ (12)`$;
- $`(312) = (32) \circ (31)`$;

Визуализируем последовательное применение **независимых циклов** $`(123)(4)`$ и последовательное применение **транспозиций** из обоих вариантов разложения к одной и той же перестановке $`1234`$:
![applying_transpositions](/img/applying_transpositions.png)

Во всех случаях мы получили **одинаковый результат** - перестановку $`2314`$.<br>

<br>

**Пример**. Разложить данную перестановку в **произведение транспозиций**:<br>

$`\phi = \left( \begin{matrix}
    1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    8 & 7 & 2 & 1 & 6 & 5 & 3 & 4
\end{matrix}\right)`$.
<br>

Разложим ее в произведение циклов: $`\phi = (184) \circ (273) \circ (56)`$.<br>
Далее раскладываем циклы в произведение транспозиций:
- $`(184) = (18) \circ (14)`$;
- $`(273) = (27) \circ (23)`$;

Следовательно: $`\phi = (18) \circ (14) \circ (27) \circ (23) \circ (56)`$.<br>

<br>

## Смежные транспозиции
An **adjacent transposition** is defined as a transposition where the **two elements** are **consecutive integers**. Hence, $`(12)`$ is an **adjacent transposition** but $`(13)`$ is **not**.<br>

**Every transposition** is the **product** of **adjacent transpositions**: $`(13)=(12)(23)(21)`$.

<br>

If $`i \lt j`$ and $`n`$ is number of elements in permuation, then you can express the transposition $`(ij)`$ as a product of **adjacent transpositions**: $`(ij)=(i+1,i) \circ (i+2,i+1) \circ \dots (n-1,n-2) \circ (n,n-1) \circ (n-1,n-2)\circ \dots \circ (i+2,i+1) \circ (i+1,i)`$.<br>

**Example**, $`(72)=(32)(43)(54)(65)⋅(76)⋅(65)(54)(43)(32)`$, here we take $`2 \lt 7`$ and form $`(2+1,2) (2+2, 2+1) ... (7,6) ... (2+1,2)`$.<br>

<br>

**Example**. Write **cycle** $`(1,2,4,3)`$ as a **product** of **adjacent transpositions**:
- we know that: $`(1243)=(13)(14)(12)`$, **but**, $`(13)`$ and $`(14)`$ are **not** adjacent;
- but we can write: $`(1243)=(12)(34)(23)`$, here **all** transpositions are **adjacent**;

<br>

# Чётность перестановки
У каждой перестановки есть **знак перестановки** (**sign of a permutation**) (aka **сигнатура**): либо **+1** либо **-1**.<br>
Все перестановки делятся на **чётные** (**even**) и **нечётные** (**odd**).<br>

Соотношение **знака** перестановки с её **чётностью** (**parity**):
- если перестановка **чётная**, то ее **знак** **+1**: $`\text{sgn}(\phi) = 1`$;
- если перестановка **нечётная**, то ее **знак** **-1**: $`\text{sgn}(\phi) = -1`$;

<br>

**Главное свойства знака** перестановки: **знак** *произведения* перестановок равен *произведению* их **знаков**: $`\text{sgn}(\phi \circ \psi) = \text{sgn}(\phi) \cdot \text{sgn}(\psi)`$.<br>

**Следствия** *главного свойства знака*:
- произведение **чётной** и **не**чётной перестановок - **не**чётная перестановка, т.к. её **знак** равен произведению $`1 \cdot (-1) = -1`$;
- произведение **двух чётных** перестановок - **чётная** перестановка, т.к. её **знак** равен произведению $`1 \cdot 1 = 1`$;
- произведение **двух не**чётных перестановок - **чётная** перестановка, т.к. её **знак** равен произведению $`(-1) \cdot (-1) = 1`$;

<br>

Существет 2 подхода для определения **знака** (**чётности**) перестановки:
- через подсчет числа **инверсий**;
- через подсчет числа **транспозиций**;

<br>

## Через подсчет числа инверсий
**Чётность** (**parity**) перестановки $`\phi`$ это **чётность** числа **всех её инверсий**.<br>

**Знак** произвольной перестановки $`\phi`$ определяется как: $`\text{sgn}(\phi) = (-1)^{N}`$, где $`N`$ - это **число инверсий** в *перестановке* $`\phi`$.<br>

<br>

**Следствия**:
- **тождественная перестановка** $`\varepsilon`$ - **всегда чётная перестановка**, т.к. в ней **0** инверсий;
- **композиция** перестановки $`\phi`$ и обратной к ней $`\phi^{-1}`$ есть **чётная** перестановка;

<br>

Например, для перестановки $`\phi = (45132)`$ **все** её **инверсии**: $`\{1,4\}, \{1,5\}, \{2,4\}, \{2,5\}, \{2,3\}, \{3,4\}, \{3,5\}`$. Всего **7** инверсий. Т.к. **7** - **нечётное** число, то перестановка - **нечётная**.<br>

Минусы данного подхода:
- понятие инверсии предполагает **отношение порядка** между элементами множества, однако, множество может содержать элементы разной природы и элементы могут и **не иметь** *отношения порядка*;
- подсчет числа инверсий работает за $`O(n^2)`$, т.к. максимальное число инверсий это $`C^{2}_{n}`$;

<br>

## Через подсчет числа транспозиций
Любую *перестановку* можно разложить в *произведение транспозиций* **многими** способами, **чётность числа транспозиций** во всех таких разложениях **одинакова**. Другими словами, **чётность числа транспозиций** определяет **чётность перестановки**.<br>

*Следствия*:
- **чётность цикла** противоположна чётности его длины;
  - цикл **чётной** длины - **не**чётная перестановка;
  - цикл **не**чётной длины - **чётная** перестановка;
- всякая **транспозиция** есть **нечётная перестановка**;

<br>

**Знак** произвольной перестановки $`\phi`$ определяется как: $`\text{sgn}(\phi) = (-1)^{t}`$, где $`t`$ - это **число транспозиций** в каком-то **разложении** *перестановки* $`\phi`$.<br>

**Число транспозиций** можно посчитать за **линейное** время.<br>

<br>

# Свойства транспозиций
Очевидно, что если последовательно применить к некоторой перестановке **одну и ту же транспозицию**  **2** раза подряд то мы получим **исходную** перестановку, т.е. **произведение двух транспозиций** есть **тождественная перестановка**: $`(ij) \circ (ij)= \varepsilon`$. А значит, **транспозиция** является **обратной самой себе**: $`(ij) = (ij)^{–1}`$.<br>

**Теорема**: от любой перестановки можно перейти к любой другой при помощи последовательно выполненных транспозиций.<br>

**Теорема**: **умножение** перестановки на **1** транспозицию **меняет** её чётность: **чётная** стновится **нечётной**, а **нечётная** становится **чётной**.<br>

*Доказательство*.
В случае соседних элементов $`s_{i}`$ и $`s_{i+1}`$ все очевидно: взаимная престановка сосдених элементов приводит либо к **увеличению** либо к **уменьшению** общего числа инверсии.<br>
Транспозицию элементов $`s_{i}`$ и $`s_{i+k}`$ между которыми находится $`k`$ элементов можно рассматривать как результат
- $`k+1`$ **последовательных** транспозиций элемента $`s_{i}`$ с соседними элементами, расположенными справа от $`s_{i}`$:
![transpositions-1](/img/transpositions-1.png)
- затем $`k`$ **последовательных** транспозиций элемента $`s_{i+k}`$ с соседними элементами, расположенными слева от $`s_{i+k}`$:
![transpositions-2](/img/transpositions-2.png)

*Доказано*.

Полное число транспозиций: $`k+1+k = 2k + 1`$:
- если $`k`$ **чётно**, то и $`2k + 1`$ **нечётно**;
- если $`k`$ **не**чётно, то $`2k + 1`$ тоже **не**чётно;

<br>

*Следствие*:
- при умножении на **чётное** число транспозиций *перестановка* **не** меняет чётность;
- при умножении на **нечётное** число транспозиций *перестановка* **меняет** чётность;

<br>

# Порядок перестановки
Рассмотрим последовательность перестановок получающихся умножением $`\phi`$ на себя: $`\phi`$, $`\phi^2`$, $`\phi^3`$, ..., $`\phi^{i}`$. Мы увидим, что $`\phi^{i} = \varepsilon`$ при некотором $`i=k`$ и $`\phi^{i} \ne \varepsilon`$ для всех $`i \lt k`$.<br>

**Теорема**: пусть $`\phi`$ произвольная перестановка конечного множества $`M`$, тогда найдется такое $`n`$, что:<br>
$`\phi^{n} = \underbrace{\phi \space \circ \space \phi \circ ... \space \circ \space \phi}_{n \space  \text{times}} = \varepsilon`$, где $`\varepsilon`$ - **тождественная перестановка**.<br>

**Порядок перестановки** $`\phi`$ - это **минимальное** число $`k`$, при котором $`\phi^{k} = \varepsilon`$.<br>

**Порядок перестановки** $`\phi`$ обозначается $`ord \space \phi`$.<br>

Правило нахождения порядка перестановки.
МЫ знаем, что любую перестановку можно разложить в произведение попарно взаимно простых циклов:<br>
$`\phi = \phi_{1} \circ \phi_{2} \circ \phi_{3} \circ \dots \circ \phi_{s}`$.<br>
Для любых номеров $`i`$ и $`j`$ произведение перестановок $`\phi_{i}`$ и $`\phi_{j}`$ **не зависит** от порядка множителей, а значит **k-ую** степень перестановки можно записать так:<br>
$`\phi^{k} = \phi_{1}^{k} \circ \phi_{2}^{k} \circ \phi_{3}^{k} \circ \dots \phi_{s}^{k}`$.<br>

**k-ая** степень перестановки $`\phi^{k}`$ **станет равна** тождественной перестановке
$`\phi^{k} = \varepsilon`$ тогда, когда **k-ая** степень **каждого** сомножителя **станет равна** тождественной перестановке: $`\phi_{i}^{k} = \varepsilon \space \space \forall i \in [1, s]`$.

Более формально, $`\phi^{i} = \varepsilon`$ тогда и только тогда, когда одновременно:

$`\phi_{1}^{i} = \varepsilon`$, $`\phi_{2}^{i} = \varepsilon`$, $`\phi_{3}^{i} = \varepsilon`$, ..., $`\phi_{s}^{i} = \varepsilon`$ (1).<br>
Если перестановки $`\phi_{1}, \space \phi_{2}, \space \dots, \space \phi_{s}`$ есть **циклы** длины $`k_{1}, \space k_{2}, \space \dots, \space k_{s}`$ соответственно, т.е. имеют порядки $`k_{1}, \space k_{2}, \space \dots, \space k_{s}`$, то наименьшее число **i**, для которого одновременно выполняются все равенства (1), равняется, очевидно **наименьшему общему кратному** чисел $`k_{1}, \space k_{2}, \space \dots, \space k_{s}`$.<br>

<br>

# Связь перестановок с числами Стирлинга первого рода
**Stirling numbers of the first kind** $`s(n, k)`$ define the **number of permutations** of set $`\{1,2,\dots,n\}`$ with **exactly** $`k`$ **cycles**.<br>
